<html>
<head>
    <title>Gruppengenerator</title>
</head>
<body>
    <table width="100%">
        <tr>
            <td width="50%" style="vertical-align:top;">
                <h3>Klasse</h3>
                <textarea cols="50" rows="25" id="namen-klasse"></textarea></br>
                <label for="group-size">Gruppengrösse</label>
                <input type="number" id="group-size" name="group-size" value="3" />
                <button id="shuffle-button">Shuffle</button>
            </td>
            <td width="50%" style="vertical-align:top;">

                <h3>Gruppen</h3>
                <ol id="groups-result"></ol>
            </td>
        </tr>
    </table>
    <script>
        const klassenNamenTextArea = document.getElementById("namen-klasse");
        const shuffleButton = document.getElementById("shuffle-button");
        const groupSize = document.getElementById("group-size");
        const groupResult = document.getElementById("groups-result");

        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        const chunkify = (array, n) => {
            let chunks = Math.floor(array.length / n);
            console.log(array.length);
            console.log(chunks);
            let result = [];
            for (let i = chunks; i > 0; i--) {
                result.push(array.splice(0, Math.ceil(array.length / i)));
            }
            return result;
        }

        klasseName = [];
        const readKlasseNamen = function () {
            klasseName = klassenNamenTextArea.value.split(/\r?\n/);
            shuffleArray(klasseName);
            if (groupSize.value <= 1) {
                alert("Gruppengrösse muss mindestens 2 sein.")
                return;
            }
            groups = chunkify(klasseName, groupSize.value);

            let groupsResultString = '';

            groups.forEach(g => {
                groupsResultString += "<li><ul>";
                g.forEach(l => {
                    groupsResultString += `<li>${l}</li>`
                })
                groupsResultString += "</ul></li>";
            });
            groupResult.innerHTML = "";
            groupResult.insertAdjacentHTML('beforeend', groupsResultString);
        }

        shuffleButton.addEventListener('click', readKlasseNamen);
    </script>
</body>

</html>